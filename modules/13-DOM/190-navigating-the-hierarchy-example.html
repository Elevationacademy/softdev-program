<!DOCTYPE html>
<style>
    .visible {
    height: 100px;
    overflow: hidden;
    transition: height 0.2s ease-in;
  }

  .invisible {
    height: 0;
    overflow: hidden;
    transition: height 0.2s ease-in;
  }
  .poppedup {
    background-color: purple;
  }
</style>
<ul class="menu">
  <li><span>AAA</span>
    <ul class="visible">
      <li>AAA-1</li>
      <li>AAA-2</li>
      <li>AAA-3</li>
    </ul>
  </li>
  <li><span>BBB</span>
    <ul class="visible">
      <li>BBB-1</li>
      <li>BBB-2</li>
      <li>BBB-3</li>
    </ul>
  </li>
  <li><span>CCC</span>
    <ul class="visible">
      <li>CCC-1</li>
      <li>CCC-2</li>
      <li>CCC-3</li>
    </ul>
  </li>
</ul>
<script>
  const menuElements = [...document.querySelectorAll('.menu')]

  for (const menuElement of menuElements) {
    addBehaviorToMenu(menuElement)
  }

  function addBehaviorToMenu(aMenuElement) {
    aMenuElement.addEventListener('click', event => {
      const spanClicked = event.target
      const liClicked = spanClicked.parentNode
      const subMenu = liClicked.querySelector('ul')

      if (subMenu.className === 'visible') {
        subMenu.className = 'invisible'
      }
      else {
        subMenu.className = 'visible'
      }

      const parentLi = subMenu.parentNode
      const titleElement = parentLi.children[0]
      if (titleElement.className === 'poppedup') {
        titleElement.className = ''
      }
      else {
        titleElement.className = 'poppedup'
      }
    })
  }
</script>


<!--
  * addEventListener
  * mouseover
  * Event delegation works because events bubbles up
  * event.target
  * Remember the DOM hierarchy:
  *   https://docs.google.com/presentation/d/1luOPPgTV24eFl2bI_SM-ibt-vqYfQek2lcHEb2ifT1o/subMenu.className === 'visible?usp=sharing
invisible*
  * Other events:
  *   useclick
  *   mouseenter
  *   mouseleave
  *   submit (for forms)
  *   focus
  *   blur
-->
